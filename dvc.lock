schema: '2.0'
stages:
  data_acquisition:
    cmd: python source/get_data.py --params=params.yaml
    deps:
    - path: params.yaml
      hash: md5
      md5: 49e36033892905727c3752cbf3030f5a
      size: 1426
    - path: source/get_data.py
      hash: md5
      md5: 92fbf740c31eb570465d61cfa1266479
      size: 889
    params:
      params.yaml:
        data_acquisition:
          path: tutorials/versioning/data.zip
          repo: https://github.com/iterative/dataset-registry
    outs:
    - path: data.zip
      hash: md5
      md5: fa9c0eb4173d86695b4e800219651360
      size: 41122310
  data_preprocess:
    cmd: python source/data_preprocess.py --params=params.yaml
    deps:
    - path: params.yaml
      hash: md5
      md5: 49e36033892905727c3752cbf3030f5a
      size: 1426
    - path: source/data_preprocess.py
      hash: md5
      md5: 62bf5b9467f66148da1013640c136224
      size: 1853
    params:
      params.yaml:
        data_preprocess:
          abspath: data.zip
          images_path: data/train/**/*
  data_augmentation:
    cmd: python source/data_augmentation.py --params=params.yaml
    deps:
    - path: data/
      hash: md5
      md5: 6ba4e05a97e7757ad4133fcf7729ce27.dir
      size: 41474755
      nfiles: 1815
    - path: params.yaml
      hash: md5
      md5: 49e36033892905727c3752cbf3030f5a
      size: 1426
    - path: source/data_augmentation.py
      hash: md5
      md5: fca3f5db90e316cd712205a4a78ab536
      size: 2818
    params:
      params.yaml:
        data_augmentation:
          images_path: data/train/
          WithBrightnessChannels:
          - -50
          - 50
          ChangeColorTemperature:
          - 1100
          - 10000
          AddToSaturation:
          - -40
          - 40
          RemoveSaturation_mul: 0.25
          MotionBlur_k: 3
    outs:
    - path: data_aug.zip
      hash: md5
      md5: 5ff5c670e64fec653408720f398724bc
      size: 41358991
  train:
    cmd: python source/train.py --params=params.yaml
    deps:
    - path: params.yaml
      hash: md5
      md5: 49e36033892905727c3752cbf3030f5a
      size: 1426
    - path: source/train.py
      hash: md5
      md5: d17a8bb56a1e8a89225d925bed54cf73
      size: 6029
    params:
      params.yaml:
        train:
          num_classes: 2
          image_size: 224
          batch_size_training: 32
          batch_size_validation: 16
          mid_neurons: 1024
          mid_activation: relu
          drop_rate: 0.2
          end_neurons: 2
          end_activation: softmax
          class_mode: categorical
          optimizer: adam
          loss: categorical_crossentropy
          metric: accuracy
          number_epoch: 10
          abspath_data: data
          best_model_path: model/model_catdog.h5
    outs:
    - path: history.csv
      hash: md5
      md5: 323f1e1dc58a713eebbf9a129fb5227b
      size: 361
    - path: history.json
      hash: md5
      md5: 2ace4bfaa9ec820c93808d9b4803afb0
      size: 378
    - path: metrics.json
      hash: md5
      md5: 4800d58dd95b2d457749e576e39da2ef
      size: 97
    - path: model/model_catdog.h5
      hash: md5
      md5: b6a26cc26d5fde3a8a2d8cf9c60e2814
      size: 77860424
  evaluate:
    cmd: python source/evaluate.py model/model_catdog.h5 scores.json prc.json roc.json
    deps:
    - path: model/model_catdog.h5
      hash: md5
      md5: b6a26cc26d5fde3a8a2d8cf9c60e2814
      size: 77860424
    - path: source/evaluate.py
      hash: md5
      md5: abceda994f45700c90b9342abe5f0767
      size: 3148
    outs:
    - path: prc.json
      hash: md5
      md5: e1ad0dff23229a83c30c4938c03af7b2
      size: 2974
    - path: roc.json
      hash: md5
      md5: 896360465ac77d20bcd01a92a550ca96
      size: 622
    - path: scores.json
      hash: md5
      md5: 8c2f8a500985be964208a2f4fd1f4ceb
      size: 116
